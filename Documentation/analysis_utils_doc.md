# Логика работы функции `categorize_articles` – анализ и инструкция

## Общее описание

Функция `categorize_articles` анализирует тексты статей (заголовки и аннотации) и классифицирует их по тематическим подкатегориям кибербезопасности на основе ключевых слов. Поддерживает два режима работы: присвоение **одной основной категории** или **нескольких подходящих категорий**.

---

## Алгоритм работы

### 1. Валидация входных данных
- Проверка наличия данных
- Проверка обязательных колонок: `title` и `abstract`
- Определение режима работы (`primary` или `multi`)

### 2. Подготовка текста для анализа
- Объединение заголовка и аннотации в один текст
- Приведение к нижнему регистру

### 3. Система категорий и ключевых слов
- Используется **12 предопределенных категорий** кибербезопасности
- Для каждой категории определен набор регулярных выражений для поиска ключевых терминов
- Категории и их русскоязычные названия:

| Английский ID | Русское название |
|---------------|------------------|
| `cryptography` | Криптография |
| `network_security` | Сетевая безопасность |
| `malware_threats` | Вредоносное ПО и угрозы |
| `access_control` | Контроль доступа |
| `privacy_compliance` | Конфиденциальность и соответствие |
| `threat_intelligence` | Киберразведка |
| `web_security` | Веб-безопасность |
| `iot_embedded` | IoT и встроенные системы |
| `ai_security` | Безопасность ИИ |
| `blockchain_crypto` | Блокчейн и криптовалюты |
| `incident_response` | Реагирование на инциденты |
| `secure_development` | Безопасная разработка |

### 4. Подсчет соответствий
- Для каждой статьи подсчитывается количество совпадений с ключевыми словами каждой категории
- Используется функция `str_count()` для поиска по регулярным выражениям

### 5. Режим `primary` (основная категория)
- Выбирается категория с **максимальным количеством совпадений**
- Если нет совпадений, присваивается категория **"Прочее"**
- Добавляется колонка `security_category` с русским названием категории
- Добавляется `category_confidence` - максимальное количество совпадений

### 6. Режим `multi` (множественная категоризация)
- Статье присваиваются **все категории**, где количество совпадений ≥ `min_score`
- По умолчанию `min_score = 1` (хотя бы одно совпадение)
- Если нет совпадений ни с одной категорией, присваивается `["Прочее"]`
- Добавляется колонка `security_categories` - **список категорий**
- Добавляется `category_confidence` - максимальное количество совпадений

### 7. Визуализация результатов
- При `verbose = TRUE` выводится таблица распределения статей по категориям
- Выводится количество обработанных статей

---

## Вспомогательная функция `get_category_stats`

### Описание
Анализирует результаты категоризации, подсчитывает статистику по категориям.

### Возвращаемые данные
- `category` / `security_category` - название категории
- `n` - количество статей
- `percentage` - процент от общего числа
- `cumulative_pct` - кумулятивный процент

---

## Инструкция по использованию

### 1. Основное использование
```r
# Загрузка данных
data <- fetch_arxiv_data(categories = "cs.CR", max_results = 50)

# Режим одной категории
categorized_primary <- categorize_articles(data, mode = "primary")

# Режим нескольких категорий
categorized_multi <- categorize_articles(data, mode = "multi", min_score = 2)
```

### 2. Анализ результатов
```r
# Статистика для режима primary
stats_primary <- get_category_stats(categorized_primary, mode = "primary")

# Статистика для режима multi
stats_multi <- get_category_stats(categorized_multi, mode = "multi")

# Просмотр распределения категорий
print(stats_primary)
```

### 3. Настройка параметров
| Параметр | Тип | Описание | По умолчанию |
|----------|-----|----------|--------------|
| `mode` | `character` | Режим категоризации: `"primary"` или `"multi"` | `"primary"` |
| `min_score` | `numeric` | Порог для включения категории в режиме `multi` | `1` |
| `verbose` | `logical` | Вывод прогресса и статистики | `TRUE` |

---

## Структура выходных данных

### Для режима `primary`:
| Колонка | Тип | Описание |
|---------|-----|----------|
| `security_category` | `character` | Основная категория (русское название) |
| `category_confidence` | `numeric` | Уверенность (количество совпадений) |

### Для режима `multi`:
| Колонка | Тип | Описание |
|---------|-----|----------|
| `security_categories` | `list` | Список подходящих категорий |
| `category_confidence` | `numeric` | Максимальная уверенность среди всех категорий |

---

## Пример вывода
```
Начало категоризации статей...
Режим: primary

Распределение по категориям:
# A tibble: 8 × 2
  security_category                      n
  <chr>                              <int>
1 Сетевая безопасность                  12
2 Криптография                          8
3 Веб-безопасность                      6
4 Вредоносное ПО и угрозы               5
5 Безопасность ИИ                       4
6 Конфиденциальность и соответствие     3
7 IoT и встроенные системы              2
8 Прочее                                10

Категоризация завершена. Обработано статей: 50
```

---

## Особенности реализации

### 1. Производительность
- Используется векторизованный подсчет совпадений через `str_count()`
- Минимизировано использование циклов

### 2. Гибкость
- Поддерживает как строгую (одна категория), так и мягкую (несколько категорий) классификацию
- Настраиваемый порог чувствительности (`min_score`)

### 3. Расширяемость
- Категории и ключевые слова легко добавлять в функцию `.get_category_patterns()`
- Модульная структура кода

### 4. Интернационализация
- Внутренние английские идентификаторы отображаются в русские названия для вывода
- Сообщения и предупреждения на русском языке

---

## Рекомендации по использованию

1. **Для точной классификации** используйте режим `primary` с высоким `min_score`
2. **Для exploratory анализа** используйте режим `multi` с `min_score = 1`
3. **Для кастомизации** редактируйте регулярные выражения в `.get_category_patterns()`
4. **Для больших объемов данных** устанавливайте `verbose = FALSE` для ускорения работы

---

## Применение
Функция предназначена для:
- Автоматической классификации академических статей по кибербезопасности
- Анализа тематических трендов в научной литературе
- Создания тематических подборок статей
- Мета-анализа исследовательских направлений

Может быть адаптирована для других предметных областей путем изменения словаря ключевых слов.
